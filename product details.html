<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تفاصيل المنتج</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
<style>
body { font-family:"Tajawal",sans-serif; background-color:#f8f7fc; margin:0; }
/* شريط الأيقونات العلوي */
.top-bar { position:fixed; top:10px; left:20px; display:flex; align-items:center; gap:20px; z-index:1000; }
.top-bar a { position:relative; color:#333; font-size:1.5rem; text-decoration:none; }
.top-bar a:hover { color:blueviolet; }
.cart-count { position:absolute; top:-8px; right:-10px; background:blueviolet; color:#fff; font-size:12px; border-radius:50%; width:18px; height:18px; display:flex; align-items:center; justify-content:center; }
/* إشعار الإضافة */
.toast { position:fixed; bottom:30px; left:50%; transform:translateX(-50%); background:blueviolet; color:white; padding:12px 25px; border-radius:25px; font-weight:bold; box-shadow:0 2px 10px rgba(0,0,0,0.2); opacity:0; transition:opacity 0.4s, bottom 0.4s; z-index:999; }
.toast.show { opacity:1; bottom:50px; }
/* باقي التصميم */
.container { max-width:1366px; margin:5rem auto; padding:0 5rem; }
.product-wrapper { display:flex; gap:3rem; flex-wrap:wrap; }
.product-images { width:450px; }
.main-image img { width:100%; border-radius:1rem; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
.thumbs { display:flex; gap:1rem; margin-top:1rem; }
.thumbs img { width:80px; height:80px; border-radius:0.8rem; cursor:pointer; border:2px solid transparent; transition:0.3s; }
.thumbs img:hover { border-color:blueviolet; }
.product-info { flex:1; min-width:300px; }
.product-info h1 { font-size:2rem; margin-bottom:1rem; }
.price { font-size:1.8rem; color:blueviolet; margin-bottom:1rem; }
.rating { color:#ffb400; margin-bottom:1rem; }
.desc { color:#444; line-height:1.8; margin-bottom:1.5rem; }
.options label { font-weight:bold; }
.color, .size { cursor:pointer; transition:0.2s; }
.color.selected { outline:3px solid blueviolet; }
.size.selected { background:blueviolet; color:#fff; border-color:blueviolet; }
.qty-box { display:flex; align-items:center; gap:10px; margin-top:10px; }
.qty-box button { background:blueviolet; color:white; border:none; padding:6px 12px; border-radius:6px; cursor:pointer; }
.qty-box input { width:60px; text-align:center; border:1px solid #ccc; border-radius:6px; padding:5px; }
.buttons { margin-top:2rem; display:flex; gap:1rem; flex-wrap:wrap; }
.btn { padding:0.8rem 2rem; border:none; border-radius:0.5rem; cursor:pointer; color:#fff; font-size:1.1rem; transition:0.3s; }
.add-cart { background-color:blueviolet; }
.add-cart:hover { background-color:#7c39c9; }
.buy-now { background-color:#111; }
.buy-now:hover { background-color:#333; }
/* اهتزاز أيقونة السلة عند الإضافة */
@keyframes shakeCart { 0% { transform: rotate(0deg); } 25% { transform: rotate(-15deg); } 50% { transform: rotate(15deg); } 75% { transform: rotate(-10deg); } 100% { transform: rotate(0deg); } }
.shake { animation: shakeCart 0.6s ease; }
</style>
</head>
<body>

<!-- شريط أعلى الصفحة -->
<div class="top-bar">
  <a href="cart page.html"><i class="fa fa-cart-shopping"></i><span class="cart-count" id="cartCount">0</span></a>
  <a href="Favorites page.html"><i class="fas fa-heart"></i></a>
  <a href="login.html"><i class="fa-solid fa-user"></i></a>
</div>

<!-- إشعار -->
<div class="toast" id="toast"></div>

<div class="container">
  <div class="product-wrapper">
    <div class="product-images">
      <div class="main-image">
        <img id="mainImg" src="./img2/t7.jpg" alt="product">
      </div>
      <div class="thumbs">
        <img src="./img2/t3.jpg" onclick="changeImage(this)">
        <img src="./img2/t5.jpg" onclick="changeImage(this)">
        <img src="./img2/t6.jpg" onclick="changeImage(this)">
        <img src="./img2/t7.jpg" onclick="changeImage(this)">
      </div>
    </div>

    <div class="product-info">
      <h1 id="pname">اسم المنتج</h1>
      <div class="price" id="pprice">99 ر.س</div>
      <div class="rating">⭐⭐⭐⭐☆ (23 مراجعة)</div>
      <p class="desc">تيشيرت كم قصير قطن 100% قابل للتمدد</p>

      <div class="options">
        <label>اللون:</label><br>
        <div class="color-boxes" style="display:flex; gap:10px; margin:10px 0;">
          <div class="color" data-color="أسود" style="width:35px; height:35px; background:black; border-radius:0.4rem;"></div>
          <div class="color" data-color="أحمر" style="width:35px; height:35px; background:red; border-radius:0.4rem;"></div>
          <div class="color" data-color="أبيض" style="width:35px; height:35px; background:white; border:1px solid #ccc; border-radius:0.4rem;"></div>
          <div class="color" data-color="رمادي" style="width:35px; height:35px; background:gray; border-radius:0.4rem;"></div>
        </div>

        <label>المقاس:</label><br>
        <div class="size-boxes" style="display:flex; gap:10px; margin:10px 0;">
          <div class="size" data-size="M" style="width:40px; height:40px; background:#fff; border:1px solid #ccc; display:flex; align-items:center; justify-content:center; border-radius:0.4rem;">M</div>
          <div class="size" data-size="L" style="width:40px; height:40px; background:#fff; border:1px solid #ccc; display:flex; align-items:center; justify-content:center; border-radius:0.4rem;">L</div>
          <div class="size" data-size="XL" style="width:40px; height:40px; background:#fff; border:1px solid #ccc; display:flex; align-items:center; justify-content:center; border-radius:0.4rem;">XL</div>
          <div class="size" data-size="XXL" style="width:40px; height:40px; background:#fff; border:1px solid #ccc; display:flex; align-items:center; justify-content:center; border-radius:0.4rem;">XXL</div>
        </div>

        <label>الكمية:</label>
        <div class="qty-box">
          <button id="minusBtn">-</button>
          <input type="number" id="qtyInput" value="1" min="1" max="10">
          <button id="plusBtn">+</button>
        </div>
      </div>

      <div class="buttons">
        <button class="btn add-cart" id="addCartBtn">إضافة للسلة</button>
        <button class="btn buy-now" id="buyNowBtn">شراء الآن</button>
      </div>
    </div>
  </div>
</div>

<script>
// تغيير الصورة الرئيسية
function changeImage(el){ document.getElementById("mainImg").src = el.src; }

// تحديد اللون والمقاس
let selectedColor = null, selectedSize = null;
document.querySelectorAll(".color").forEach(c=>{
  c.addEventListener("click", ()=>{
    document.querySelectorAll(".color").forEach(cl=>cl.classList.remove("selected"));
    c.classList.add("selected"); selectedColor = c.dataset.color;
  });
});
document.querySelectorAll(".size").forEach(s=>{
  s.addEventListener("click", ()=>{
    document.querySelectorAll(".size").forEach(sl=>sl.classList.remove("selected"));
    s.classList.add("selected"); selectedSize = s.dataset.size;
  });
});

// الكمية
const qtyInput = document.getElementById("qtyInput");
document.getElementById("plusBtn").onclick = ()=>{ if(qtyInput.value < 10) qtyInput.value++; };
document.getElementById("minusBtn").onclick = ()=>{ if(qtyInput.value > 1) qtyInput.value--; };

// تحديث رقم السلة
function updateCartCount(){
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  document.getElementById("cartCount").innerText = cart.length;
}
updateCartCount();

// إشعار
function showToast(msg){
  const toast = document.getElementById("toast");
  toast.innerText = msg;
  toast.classList.add("show");
  setTimeout(()=> toast.classList.remove("show"), 2000);
}

// إضافة المنتج للسلة (واحدة فقط)
function saveToCart(redirect=false){
  const name = document.getElementById("pname").innerText;
  const price = document.getElementById("pprice").innerText;
  const image = document.getElementById("mainImg").src;
  const quantity = qtyInput.value;

  // التحقق من اختيار اللون والمقاس
  if(!selectedColor || !selectedSize){
    showToast("⚠️ اختر اللون والمقاس أولاً");
    return;
  }

  const currentProduct = JSON.parse(localStorage.getItem("currentProduct"));
  const id = currentProduct?.id || "غير محدد";

  const product = { id, name, price, image, color:selectedColor, size:selectedSize, quantity };

  let cart = JSON.parse(localStorage.getItem("cart")) || [];
  cart.push(product);
  localStorage.setItem("cart", JSON.stringify(cart));

  updateCartCount();
  showToast("✅ تمت إضافة المنتج إلى السلة");

  // اهتزاز أيقونة السلة
  const cartIcon = document.querySelector(".fa-cart-shopping");
  if(cartIcon){
    cartIcon.classList.add("shake");
    setTimeout(()=>cartIcon.classList.remove("shake"),600);
  }

  // التوجيه لصفحة السلة إذا زر شراء الآن
  if(redirect) setTimeout(()=>window.location.href="cart page.html",1200);
}

// ربط الأزرار
document.getElementById("addCartBtn").addEventListener("click", ()=>saveToCart(false));
document.getElementById("buyNowBtn").addEventListener("click", ()=>saveToCart(true));

// تحميل بيانات المنتج من localStorage
window.addEventListener("DOMContentLoaded", ()=>{
  const current = JSON.parse(localStorage.getItem("currentProduct"));
  if(current){
    document.getElementById("pname").innerText = current.name;
    document.getElementById("pprice").innerText = current.price;
    document.getElementById("mainImg").src = current.image;
  }
});
</script>

</body>
</html>